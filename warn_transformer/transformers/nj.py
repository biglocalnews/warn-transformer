import typing
from datetime import datetime

from ..schema import BaseTransformer


class Transformer(BaseTransformer):
    """Transform New Jersey raw data for consolidation."""

    postal_code = "NJ"
    fields = dict(
        company="Company",
        location="City",
        effective_date="Effective Date",
        jobs="Workforce Affected",
    )
    date_format = ["%Y-%m-%d %H:%M:%S", "%M/%d/%Y", "%M/%d/%y"]
    jobs_corrections = {
        "TBA": None,
        "To be Determined": None,
        "-": None,
        "Unknown": None,
        23695: None,
        # The United airlines number is legimate, though nationwide
        # https://abcnews.go.com/Politics/united-airlines-furlough-16000-employees/story?id=72771897
        16000: 16000,
        "240 (Passaic) 417 (Bergen) 141 (Monmouth) 44 (Hudson) 29 (Statewide)": 871,
    }
    date_corrections = {
        "TBA": None,
        "TBD": None,
        "Temp layoff": None,
        "-": None,
        "3030-08-23 00:00:00": datetime(2020, 8, 23),
        "04/22/2022, 09/30/2022, 12/21/22": datetime(2022, 4, 22),
        "08/15/2023, 8/22/2023": datetime(2024, 8, 15),
        "7/7/23 - 08/23": datetime(2023, 7, 7),
        "7/723 -  08/23": datetime(2023, 7, 7),
        "7/7/23 - 8/2023": datetime(2023, 7, 7),
        "7/723 -  8/2023": datetime(2023, 7, 7),
        "10/23/2023 - 12/15/2023": datetime(2023, 10, 23),
        "09/15/2023 - 12/06/2023": datetime(2023, 9, 15),
        "09/30/2023 - 12/31/2023": datetime(2023, 9, 30),
        "9/15/2023 - 12/06/2023": datetime(2023, 9, 15),
        "9/30/2023 - 12/31/2023": datetime(2023, 9, 30),
        "11/17/2023 - 12/01/2023": datetime(2023, 11, 17),
        "11/15/2023 - 12/31/2023": datetime(2023, 11, 15),
        "10/1/2023,10/31/2023,11/05/2023, 1/31/2024,1/1/2024,3/1/2024, 4/1/2024": datetime(
            2023, 10, 1
        ),
        "12/31/24, 9/27/24, 8/30/24, 5/31/24, 1/31/24, 12/13/2023, 10/25/2023, 9/27/2023, 9/20/2023, 9/18/2023,9/7/2023, 4/13/23, 3/30/23": None,
        "12/31/2024, 9/27/2024, 8/30/2024, 5/31/2024, 1/31/2024, 12/13/2023, 10/25/2023, 9/27/2023, 9/20/2023, 9/18/2023,9/7/2023, 4/13/2023, 3/30/2023": None,
        "2/2/2024 - 2/23/2024 3/31/2025 -04/14/2025": datetime(2024, 2, 2),
        "12/31/2023 , 1/1/2024, 2/15/2024": datetime(2023, 12, 31),
        "11/15/23 ,12/31/2023 , 1/1/2024, 01/31/24, 2/15/2024": datetime(2023, 11, 15),
        "01/27/2024, 02/10/2024": datetime(2024, 1, 27),
        "2/13/24,3/15/24": datetime(2024, 2, 13),
        "4/5/2024, 3/31/2024": datetime(2024, 3, 31),
        "1/12/2024 - 4/30/2024": datetime(2024, 1, 12),
        "3/15/2024, 5/24/2024/, 6/21/2024": datetime(2024, 3, 15),
        "7/6/24,6/7/24,6/14/24, 6/21/24,7/26/24,8/2/24,8/30/24, 9/27/24": datetime(
            2024, 6, 7
        ),
        "04/15/24 through 06/28/24 , 07/2/24, 07/31/24, 09/01/24, 09/30/24": datetime(
            2024, 4, 15
        ),
        "02/19/2024, 03/2024, 08/2024": datetime(2024, 2, 19),
        "09/27/24,06/28/24,05/31/24,03/28/25": datetime(2024, 9, 27),
        "4/5/24, 3/31/24": datetime(2024, 3, 31),
        "1/12/24 - 4/30/24": datetime(2024, 1, 12),
        "3/15/24, 5/24/24/, 6/21/24": datetime(2024, 3, 15),
        "3/15/24, 5/24/24, 6/21/24": datetime(2024, 3, 15),
        "02/19/24, 03/24, 08/24": datetime(2024, 2, 19),
        "1/10/24/, 2/13/24, 3/9/24, 3/11/24": datetime(2024, 1, 10),
        "1/10/24, 2/13/24, 3/9/24, 3/11/24": datetime(2024, 1, 10),
        "4/22/24, 5/30/24,6/14/24,7/12/24,10/4/24,11/1/2412/6/24,2/21/24": datetime(
            2024, 4, 22
        ),
        "04/30/2024, 05/18/2024, 05/28/2024, 05/30/2024, 06/12/2024, and 06/29/2024": datetime(
            2024, 4, 30
        ),
        "8/1/24, 11/1/24, 1/1/25, 3/1/25,4/1/25": datetime(2024, 8, 1),
        "6/21/24, 9/30/24, 12/31,24": datetime(2024, 6, 21),
        "5/20/2024, 5/21/24, 5/22/24": datetime(2024, 5, 20),
        "8/14/24,11/1/24,1/31/24": datetime(
            2024, 8, 14
        ),  # Third date seems likely a typo out of order
        "6/17/24,6/21/24,6/26/24, 7/2/24,7/9/24, 7/10/24, 7/15/24, 7/18/24, 7/19/24, 8/1/24, 8/7/24, 8/21/24": datetime(
            2024, 6, 17
        ),
        "8/21/24 - 9/3/24": datetime(2024, 8, 21),
        "8/22/24,10/22/24": datetime(2024, 8, 22),
        "06/28/24,7/25/24,8/2/2024,8/15/24,9/30/24,10/1/24,12/16/24": datetime(
            2024, 6, 28
        ),
        "7/15/24-7/26/2024": datetime(2024, 7, 15),
        "9/6/2024, 9/13/2024,10/18/2024, 11/22/2024": datetime(2024, 9, 6),
        "9/6/204": datetime(2024, 9, 6),
        "7/16/2024-9/20/2024; 1/6/2025": datetime(2024, 7, 16),
        "10/1/24; 10/4/24; 11/8/24; 12/6/24; 12/16/24; 12/31/24; 1/3/25; 1/10/25; 1/31/25; 4/25/25; 5/1/25; 5/2/25; 5/15/25; 6/30/25; 7/1/25; 9/2/25; 11/7/25; 12/19/25.": datetime(
            2024, 10, 1
        ),
        "8/23/24 - 9/5/24": datetime(2024, 8, 23),
        "09/27/24, 06/12/24,6/14/24, 06/28/24,05/31/24,03/28/25": datetime(2024, 9, 27),
        "11/11/24,11/29/24,12/27/24": datetime(2024, 11, 11),
        "11/24/24, 12/6/24": datetime(2024, 11, 24),
        "12/1/24, 12/9/24,12/16/24": datetime(2024, 12, 1),
        "12/11/24, 1/22/25": datetime(2024, 12, 11),
        "12/12/24,12/20/24,3/21/25,3/31/25,5/30/25": datetime(2024, 12, 12),
        "7/5/24, 7/12/24, 7/19/24, 7/20/24, 8/30/24, 9/27/24, 10/1/24, 10/25/24, 11/1/24, 11/29/24, 12/27/24, 12/31/24": datetime(
            2024, 7, 5
        ),
        "12/26/2024 - 12/31/2024": datetime(2024, 12, 26),
        "12/26/24 - 12/31/24": datetime(2024, 12, 26),
        "1/3/25 - 1/16/25": datetime(2025, 1, 3),
        "9/27/24, 9/29/25, 10/29/24": datetime(2024, 9, 27),
        "11/7/25,12/26/25,3/28/25": datetime(2025, 3, 28),
        "11/15/24, 12/31/24": datetime(2024, 11, 15),
        "12/27/24, 1/30/25": datetime(2024, 12, 27),
        "4/24/25, 7/3/25, 7/18/25, 7/31/25, 12/11/25": datetime(2024, 4, 25),
        "1/31/25 and 2/3/25": datetime(2025, 1, 31),
        "6/30/25 - 12/31/25": datetime(2025, 6, 30),
        "3/31/25, 4/7/25, 4/30/25, 5/30/25": datetime(2025, 3, 31),
        "5/22/25, 6/6/25, 6/20/25, 8/1/25": datetime(2025, 5, 22),
        "5/29/25 - 6/12/25": datetime(2025, 5, 29),
        "7/31/25 - 6/3/26": datetime(2025, 7, 31),
        "2/7/25, 2/21/25, 3/3/25, 4/4/25, 8/5/25": datetime(2025, 2, 7),
        "12/27/24 - 4/17/2025": datetime(2024, 12, 27),
        "2/13/25, 2/21/25, 3/31/25, 4/1/25, 4/30/25, 5/29/25, 5/31/25, 6/30/25, 7/31/25, 9/30/25, 10/31/25, 12/31/25": datetime(
            2025, 2, 13
        ),
        "2/21/25 - 8/28/25": datetime(2025, 2, 21),
        "12/31/2024 - 06/30/2025, 09/30/2025, and 12/31/2025": datetime(2024, 12, 31),
        "1/31/2025, 3/5/2025, 3/16/25, 4/16/25": datetime(2025, 1, 31),
        "4/4/25 - 5/5/25": datetime(2025, 4, 4),
        "6/13/25 - 10/24/25": datetime(2025, 6, 13),
        "6/11/25 - 6/25/25": datetime(2025, 6, 11),
        "06/23/25 - 07/7/25": datetime(2025, 6, 23),
        "03/25/25 - 3/27/25": datetime(2025, 3, 25),
        "03/31/25, 4/29/25, 5/19/25, 6/5/25, 6/16/25, 6/23/25, 6/25/25, 6/26/25": datetime(
            2025, 3, 31
        ),
        "1/1/25 - 3/31/25": datetime(2025, 1, 1),
        "4/30/25, 5/30/25, 5/31/25": datetime(2025, 4, 30),
        "9/8/24 - 8/1/25": datetime(2024, 9, 8),
        "3/15/25, 3/29/25, 4/12/25, 7/3/25": datetime(2025, 3, 15),
        "5/9/25, 7/31/25, 8/29/25, 9/1/25, 9/30/25, 10/3/25, 10/10/25, 10/24/25, 11/21/25, 12/5/25, 12/12/25, 12/19/25, 1/2/26, 3/27/26": datetime(
            2025, 5, 9
        ),
        "Rolling basis beginning on 6/4/25": datetime(2025, 6, 4),
        "5/1/25, 5/3/25, 5/8/25, 6/1/25/ 6/16/25, 8/1/25, 8/22/25, 9/1/25, 10/1/25, 12/1/25, 1/1/26": datetime(
            2025, 5, 1
        ),
        "8/15/25 - 8/29/25": datetime(2025, 8, 15),
        "6/6/25 - 6/30/25": datetime(2025, 6, 6),
        "9/8/25, 9/10/25, 9/12/25": datetime(2025, 9, 8),
        "6/27/25,7/11/25, 8/11/25, 8/29/25, 9/11/25, 10/31/25, 11/1/25, 11/17/25, 2/14/26": datetime(
            2025, 6, 27
        ),
        "10/10/25, 12/19/25": datetime(2025, 10, 10),
        "9/25/25, 10/24/25, 12/19/25, 1/15/26": datetime(2025, 9, 25),
        "8/1/25, 8/29/25, 9/30/25": datetime(2025, 8, 1),
        "7/31/25 - 10/18/25": datetime(2025, 7, 31),
        "10/23/25 - 12/31/25": datetime(2025, 10, 23),
        "10/21/25, 10/28/25, 10/29/25, 11/3/25, 11/9/25": datetime(2025, 10, 21),
        "8/12/25 and 11/7/25": datetime(2025, 8, 12),
        "9/26/25 - 11/3/25": datetime(2025, 9, 26),
        "8/15/25 - 9/29/25": datetime(2025, 8, 15),
        "6/13/25 - 8/22/25": datetime(2025, 6, 13),
        "10/21/25, 10/28/25, 10/29/25, 11/3/25, 11/9/25, 11/15/25": datetime(
            2025, 10, 21
        ),
        "11/28/25, 12/31/25, 1/19/26, 1/30/26, 3/6/26, 6/26/26": datetime(2025, 11, 28),
        "7/14/25 - 9/15/25": datetime(2025, 7, 14),
        "11/16/25 - 12/16/25": datetime(2025, 11, 16),
        "12/11/25, 2/12/26, 3/13/26, 3/27/26": datetime(2025, 12, 11),
        "9/18/25 - 10/3/25": datetime(2025, 9, 18),
        "12/8/25, 12/14/25,  12/15/25, 12/24/25, 12/27/25, 12/28/25": datetime(
            2025, 12, 8
        ),
        "9/9/25, 9/24/25, 9/25/25": datetime(2025, 9, 9),
        "12/31/25 and 1/1/26": datetime(2025, 12, 31),
        "1/4/26 & 1/23/26": datetime(2026, 1, 4),
        "1/15/26 & 1/17/26": datetime(2026, 1, 15),
        "11/19/25 - 12/2/25": datetime(2025, 11, 19),
        "11/19/25 - 12/15/25": datetime(2025, 11, 19),
        "1/23/26 & 2/13/26": datetime(2026, 1, 23),
        "12/17/2025 & 1/28/26": datetime(2025, 12, 17),
        "1/23/26, 6/26/26, 7/31/26": datetime(2026, 1, 23),
        "10/30/25 - 1/31/25": datetime(2025, 10, 30),
        "10/25/25 - 11/9/25": datetime(2025, 10, 25),
        "2/2/26 (377), 2/5/26 (4), 2/13/26 (4), 2/19/26 (2), 2/27/26 (1), and 3/4/26 (2)": datetime(
            2026, 2, 2
        ),
        "2/2/26 (120), 3/2/26 (1), and 3/4/26 (1)": datetime(2026, 2, 2),
        "2/2/26 and 2/19/26": datetime(2026, 2, 2),
        "11/4/26 - 11/6/26": datetime(2026, 11, 4),
        "1/2/26, 1/9/26, 1/12/26, 1/13/26, 1/16/26, 1/29/26": datetime(2026, 1, 2),
        "2/2/26 - 2/14/26": datetime(2026, 2, 2),
        "2/12/26 and 3/13/26": datetime(2026, 2, 12),
        "1/9/26 - 2/9/26": datetime(2026, 1, 9),
        "2/20/26, 3/6/26, 3/13/26, 5/11/26": datetime(2026, 2, 20),
        "12/31/25, 3/31/26, 6/30/26": datetime(2025, 12, 31),
        "3/11/26 - 3/24/26": datetime(2026, 3, 11),
        "9/18/25 - 12/19/25": datetime(2025, 9, 18),
        "1/15/26 & 1/17/26 (additional layoffs in February and March)": datetime(
            2026, 1, 15
        ),
        "2/2/26 , 2/14/26, 3/13/26, 4/3/26": datetime(2026, 2, 2),
        "2/6/26 - 3/16/26": datetime(2026, 2, 6),
        "3/31/26, 6/30/26, 7/31/26, 9/30/26, 11/30/26, 12/31/26": datetime(2026, 3, 31),
        "2/28/26, 3/31/26, 6/30/26": datetime(2026, 2, 28),
        "4/10/26 - 11/26/26": datetime(2026, 4, 10),
        "3/31/26 (Paramus and Ramsey), 4/30/26 (Livingston)": datetime(2026, 3, 31),
        "4/21/26 - 9/2/26": datetime(2026, 4, 21),
    }

    def transform_jobs(self, value: str) -> typing.Optional[int]:
        """Transform a raw jobs number into an integer.

        Args:
            value (str): A raw jobs number provided by the source

        Returns: An integer number ready for consolidation. Or, if the value is invalid, a None.
        """
        # Cut the asterisk they sometimes use
        value = value.replace("*", "")

        # Do the normal stuff
        return super().transform_jobs(value)
